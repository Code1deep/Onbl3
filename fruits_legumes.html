<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Épicerie Sociale - Fruits & Légumes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      background: #f9f9f9;
      font-family: 'Arial', sans-serif;
    }
    header {
      background: linear-gradient(90deg, #007bff, #28a745);
      color: white;
      padding: 15px;
      text-align: center;
    }
    .logo {
      height: 60px;
      margin-right: 10px;
    }
    .product-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .product-card:hover {
      transform: translateY(-5px);
    }
    .cart {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #007bff;
      color: white;
      padding: 10px 15px;
      border-radius: 50px;
      cursor: pointer;
      z-index: 999;
    }
    .cart-count {
      background: red;
      color: white;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 50%;
      position: absolute;
      top: -5px;
      right: -5px;
    }
    .cart-modal {
      display: none;
      position: fixed;
      top: 80px;
      right: 20px;
      width: 350px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      padding: 15px;
      z-index: 1000;
    }
    .btn-animate {
      transition: transform 0.2s;
    }
    .btn-animate:active {
      transform: scale(0.95);
    }
  </style>
</head>
<body>

<header>
  <img src="assets/logo_fr.png" class="logo" alt="Logo">
  <h1>Fruits et Légumes Solidaires</h1>
  <p>Produits frais à prix solidaires – Livraison gratuite dès 20$</p>
</header>

<div class="container my-4">
  <div class="row" id="product-list">
    <!-- Produits -->
  </div>
</div>

<!-- Icône Panier -->
<div class="cart" onclick="toggleCart()">
  <i class="fa fa-shopping-cart"></i>
  <span class="cart-count" id="cart-count">0</span>
</div>

<!-- Panier -->
<div class="cart-modal" id="cart-modal">
  <h5>Votre Panier</h5>
  <div id="cart-items"></div>
  <hr>
  <p>Sous-total: <span id="subtotal">0.00</span>$</p>
  <p>Frais livraison: <span id="shipping">0.00</span>$</p>
  <p><strong>Total: <span id="total">0.00</span>$</strong></p>
  <p id="free-shipping-msg" style="color:green; display:none;">Livraison gratuite !</p>
  <button class="btn btn-success w-100 mb-2" onclick="proceedPayment()">Paiement en ligne</button>
  <button class="btn btn-secondary w-100" onclick="callOrder()">Ou appeler: 514-123-4567</button>
</div>

<footer class="text-center p-3">
  <p>&copy; 2025 Carrefour des Initiatives Éducatives et Entrepreneuriales</p>
  <a href="https://facebook.com" target="_blank"><i class="fab fa-facebook fa-2x mx-2"></i></a>
  <a href="https://instagram.com" target="_blank"><i class="fab fa-instagram fa-2x mx-2"></i></a>
</footer>

<script>
const products = [
  {id:1, name:'Pommes (1 kg)', price:2.5, img:'assets/fruits/pommes.jpg'},
  {id:2, name:'Carottes (1 kg)', price:1.8, img:'assets/fruits/carottes.jpg'},
  {id:3, name:'Oranges (1 kg)', price:3.0, img:'assets/fruits/oranges.jpg'}
];

const cart = [];

function renderProducts(){
  const container = document.getElementById('product-list');
  container.innerHTML = '';
  products.forEach(p=>{
    container.innerHTML += `
    <div class="col-md-4 mb-4">
      <div class="product-card p-3">
        <img src="${p.img}" class="img-fluid rounded mb-2">
        <h5>${p.name}</h5>
        <p><strong>${p.price.toFixed(2)} $</strong></p>
        <input type="number" min="1" value="1" id="qty-${p.id}" class="form-control mb-2">
        <button class="btn btn-primary w-100 btn-animate" onclick="addToCart(${p.id})">
          <i class="fa fa-cart-plus"></i> Ajouter au panier
        </button>
      </div>
    </div>`;
  });
}

function addToCart(id){
  const qty = parseInt(document.getElementById('qty-'+id).value);
  const product = products.find(p=>p.id===id);
  const item = cart.find(i=>i.id===id);
  if(item){
    item.qty += qty;
  } else {
    cart.push({...product, qty:qty});
  }
  updateCart();
}

function updateCart(){
  document.getElementById('cart-count').innerText = cart.reduce((sum,i)=>sum+i.qty,0);
  let subtotal=0;
  const cartItems=document.getElementById('cart-items');
  cartItems.innerHTML='';
  cart.forEach(item=>{
    subtotal += item.price*item.qty;
    cartItems.innerHTML += `<p>${item.name} x${item.qty} = ${(item.price*item.qty).toFixed(2)}$</p>`;
  });
  let shipping = subtotal>20?0:5;
  document.getElementById('free-shipping-msg').style.display = shipping===0?'block':'none';
  document.getElementById('subtotal').innerText=subtotal.toFixed(2);
  document.getElementById('shipping').innerText=shipping.toFixed(2);
  document.getElementById('total').innerText=(subtotal+shipping).toFixed(2);
}

function toggleCart(){
  const modal=document.getElementById('cart-modal');
  modal.style.display=modal.style.display==='block'?'none':'block';
}

function proceedPayment(){
  // Ici on peut vérifier si Stripe est dispo
  const stripeAvailable=false; // mettre true si Stripe configuré
  if(!stripeAvailable){
    alert("Paiement en ligne non disponible pour le moment. Veuillez payer en magasin ou à la livraison.");
  } else {
    alert("Redirection vers Stripe...");
    // Code Stripe réel ici
  }
}

function callOrder(){
  window.location.href='tel:5141234567';
}

renderProducts();
</script>
</body>
</html>
